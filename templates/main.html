<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>메인 페이지</title>
</head>
<body>
    <h2>메인 페이지입니다.</h2>

    <div id="auth-buttons">
        <a href="/login/"><button>로그인</button></a>
        <a href="/signup/"><button>회원가입</button></a>
    </div>

    <script>
        // localStorage에서 JWT 토큰 확인
        let accessToken = localStorage.getItem("access_token");
        
        if (accessToken) {
            // 로그인 상태라면 로그인/회원가입 버튼 숨기고 로그아웃 버튼 표시
            document.getElementById("auth-buttons").innerHTML = `
                <button onclick="loadBoard()">게시판으로 이동</button>
                <button onclick="logout()">로그아웃</button>
            `;
        }

        async function loadBoard() {
            let accessToken = localStorage.getItem("access_token");

            let response = await fetch("/board/", {
                method: "GET",
                headers: {
                    "Authorization": `Bearer ${accessToken}`,  // JWT 토큰 포함
                    "Content-Type": "application/json"
                }
            });

            if (response.ok) {
                window.location.href = "/board/";  // 인증 성공 시 이동
            } else {
                alert("인증 실패: 로그인 후 이용하세요.");
                window.location.href = "/login/";  // 인증 실패 시 로그인 페이지로 이동
            }
        }

        function logout() {
            localStorage.removeItem("access_token");  // JWT 삭제
            localStorage.removeItem("refresh_token");
            window.location.href = "/";  // 로그아웃 후 메인 페이지로 이동
        }
    </script>
</body>
</html>
